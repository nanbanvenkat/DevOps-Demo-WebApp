
pipeline {
         agent any
	 environment {
	 	 def server = Artifactory.server "artifactory"
	 def rtMaven = Artifactory.newMavenBuild()
	 def buildInfo 
	 rtMaven.tool = "maven"
	 rtMaven.deployer releaseRepo:'libs-release-local', snapshotRepo:'libs-snapshot-local', server: server
         rtMaven.resolver releaseRepo:'libs-release', snapshotRepo:'libs-snapshot', server: server
	 }
	  stages {
                 stage('Clone source') {
                 steps {
                      git url: 'https://github.com/nanbanvenkat/DevOps-Demo-WebApp.git'
                 }
                 }
                 stage('Maven Build') {
                 steps {
                      buildInfo = rtMaven.run pom: 'pom.xml', goals: 'clean package', buildInfo: buildInfo
                 }
                 }
                 stage('Deploy to test') {
                 steps {
                  deploy adapters: [tomcat8(credentialsId: 'tomcat', path: '', url: 'http://52.167.166.3:8080/')], contextPath: '/QAWebapp', war: '**/*.war'
	            }
                 }
               
              }
}
